<!DOCTYPE html>
<!--
TODO
nicer hands
add numeric time written
convert to widget
publish on the store; installable PWA
consistent dark color to system color
-->
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>24-Hour Clockv2</title>
<link rel="manifest" href="manifest.json" />
<meta name="theme-color" content="#000" />
<script>
 if ("serviceWorker" in navigator) {
  navigator.serviceWorker.register("service-worker.js");
 }
</script>

<style>
 :root {
  --clock-size: 80vmin;
  --direction: normal;
 }
 body {
  margin: 0;
  display: flex;
  height: 100vh;
  justify-content: center;
  align-items: center;
  background: #000;
  color: #ccc;
 }
 .clock {
  position: relative;
  width: var(--clock-size);
  height: var(--clock-size);
  border: 0.5vmin solid #ccc;
  border-radius: 50%;
  background: linear-gradient(
   to bottom,
   brown 0%, brown 50%, darkblue 50%, darkblue 100%
  );
  box-shadow: inset 0 0 10px #444;
  user-select: none;
 }
 .ticks {
  position: absolute;
  width: 100%;
  height: 100%;
  pointer-events: none;
 }
 .tick {
  position: absolute;
  width: 0.4vmin;
  height: 14vmin;
  background: #ccc;
  left: 50%;
  top: 50%;
  transform-origin: 50% 0%;
  border-radius: 0.2vmin;
 }
 .tick.minute {
  width: 0.4vmin;
  height: 2vmin;
 }
 .center-dot {
  position: absolute;
  width: 3.5vmin;
  height: 3.5vmin;
  background: #39b;
  border-radius: 50%;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  z-index: 10;
  border: 0.1vmin solid black;
 }
 .numbers {
  position: absolute;
  width: 100%;
  height: 100%;
  font-size: 5vmin;
  font-weight: bold;
  font-family: Arial, sans-serif;
  color: #bbb;
 }
 .numbers span {
  position: absolute;
  width: 4vmin;
  height: 4vmin;
  text-align: center;
  line-height: 4vmin;
  transform: translate(-50%, -50%);
 }
 .numbers.minute {
  font-size: 3vmin;
  color: #ccc;
  font-weight: normal;
 }
 .hand {
  position: absolute;
  bottom: 50%;
  left: 50%;
  background: #ddd;
  transform-origin: bottom center;
  border-radius: 2vmin;
  border: 0.1vmin solid black;
 }
 .hand.hour {
  width: 1.5vmin;
  height: 33vmin;
  background: #f0a500;
  z-index: 4;
 }
 .hand.minute {
  width: 1.2vmin;
  height: 44vmin;
  background: #bfb;
  z-index: 3;
 }
 .hand.second {
  width: 0.5vmin;
  height: 47vmin;
  background: #e63946;
  z-index: 5;
 }
 .sun {
  position: absolute;
  width: 7vmin;
  height: 7vmin;
  background: #f0a50099;
  border-radius: 50%;
  top: 20%;
  left: 50%;
  transform: translateX(-50%);
  box-shadow: 0 0 8px #f0a500aa;
 }
</style>
</head>
<body>
<div class="clock" id="clock">
 <div class="numbers" id="numbers"></div>
 <div class="numbers minute" id="minute-numbers"></div>
 <div class="ticks" id="ticks"></div>
 <div class="hand hour" id="hour-hand"><div class="sun"></div></div>
 <div class="hand minute" id="minute-hand"></div>
 <div class="hand second" id="second-hand"></div>
 <div class="center-dot"></div>
</div>

<script>
 class Clock {
  constructor(config) {
   this.config = config;
   this.clockEl = document.getElementById('clock');
   this.hourHand = document.getElementById('hour-hand');
   this.minuteHand = document.getElementById('minute-hand');
   this.secondHand = document.getElementById('second-hand');
   this.numbersContainer = document.getElementById('numbers');
   this.minuteNumbersContainer = document.getElementById('minute-numbers');
   this.ticksContainer = document.getElementById('ticks');
   // Set CSS direction variable
   document.documentElement.style.setProperty(
    '--direction',
    config.newType ? 'reverse' : 'normal'
   );
   this.attachResizeListener();
   this.drawStaticParts();
   this.startClock();
  }

  attachResizeListener() {
   window.addEventListener('resize', () => {
    this.drawStaticParts();
   });
  }

  drawStaticParts() {
   this.generateNumbers();
   this.generateMinuteNumbers();
   this.generateTicks();
  }

  generateNumbers() {
   const { newType, onlyEvenNumbers, classic24HourNumbers } = this.config;
   this.numbersContainer.innerHTML = '';
   for (let i = 0; i < 24; i++) {
    if (!onlyEvenNumbers || i % 2 === 0) {
     const span = document.createElement('span');
     // Calculate angle
     let angle;
     if (newType) {
      angle = -(i - 6 + 0.5) * 15;
     } else {
      angle = i * 15;
     }

     // Calculate hour number shown
     let hourNumber = i;
     if (classic24HourNumbers) {
      hourNumber = (hourNumber + 6 - 1) % 12 + 1;
     } else {
      hourNumber = hourNumber % 24;
     }

     const radius = 44;
     const rad = (angle - 90) * Math.PI / 180;
     const x = 50 + radius * Math.cos(rad);
     const y = 50 + radius * Math.sin(rad);
     span.style.left = `${x}%`;
     span.style.top = `${y}%`;
     span.textContent = hourNumber;
     this.numbersContainer.appendChild(span);
    }
   }
  }

  generateMinuteNumbers() {
   const { classicMinutePositioning } = this.config;
   this.minuteNumbersContainer.innerHTML = '';
   const radius2 = 59;
   for (let i = 0; i < 60; i += 5) {
    const span = document.createElement('span');
    let angle = i * 6;
    if (classicMinutePositioning) {
     angle -= 90;
    }
    const rad = (180 - angle) * Math.PI / 180;
    const x = 50 + radius2 * Math.cos(rad);
    const y = 50 + radius2 * Math.sin(rad);
    span.style.left = `${x}%`;
    span.style.top = `${y}%`;
    span.textContent = i === 0 ? '0' : i.toString();
    this.minuteNumbersContainer.appendChild(span);
   }
  }

  generateTicks() {
   this.ticksContainer.innerHTML = '';
   const totalTicks = 24;
   for (let i = 0; i < totalTicks; i++) {
    const tick = document.createElement('div');
    tick.className = 'tick';
    tick.style.transform = `rotate(${i * 15}deg) translateY(-40.5vmin)`;
    this.ticksContainer.appendChild(tick);
   }
   for (let i = 0; i < 60; i++) {
    const tick = document.createElement('div');
    tick.className = 'tick minute';
    tick.style.transform = `rotate(${i * 6}deg) translateY(-42vmin)`;
    this.ticksContainer.appendChild(tick);
   }
  }

  updateClock() {
   const now = new Date();
   let hour = now.getHours();
   let minute = now.getMinutes();
   let second = now.getSeconds();
   const { newType, classicMinutePositioning } = this.config;

   if (newType) {
    hour = (hour - 6 + 24) % 24;
   }

   let hourDeg = (hour + minute / 60) * 15;
   let minuteDeg = minute * 6;
   let secondDeg = second * 6;

   if (newType) {
    hourDeg = -hourDeg + 90;
    minuteDeg = -minuteDeg - 90;
    secondDeg = -secondDeg - 90;
   }

   if (classicMinutePositioning) {
    minuteDeg += 90;
    secondDeg += 90;
   }

   this.hourHand.style.transform = `translateX(-50%) rotate(${hourDeg}deg)`;
   this.minuteHand.style.transform = `translateX(-50%) rotate(${minuteDeg}deg)`;
   this.secondHand.style.transform = `translateX(-50%) rotate(${secondDeg}deg)`;
  }

  startClock() {
   this.updateClock();
   setInterval(() => this.updateClock(), 1000);
  }
 }

 // Configuration
 const clockConfig = {
  newType: true,
  classic24HourNumbers: true,
  onlyEvenNumbers: false,
  classicMinutePositioning: true,
 };

 // Initialize clock
 const clock = new Clock(clockConfig);

</script>
</body>
</html>
